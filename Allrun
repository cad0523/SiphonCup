#!/bin/sh
cd "${0%/*}" || exit                                # Run from this directory
. ${WM_PROJECT_DIR:?}/bin/tools/RunFunctions        # Tutorial run functions
#------------------------------------------------------------------------------

touch tmp.foam
mkdir -p constant/triSurface
runApplication surfaceTransformPoints -scale '(0.001 0.001 0.001)' SiphonCup.stl SiphonCup_0.001.stl
cp SiphonCup_0.001.stl constant/triSurface/

runApplication surfaceFeatureExtract
runApplication blockMesh
runApplication topoSet -dict system/topoSetDict
runApplication refineMesh -dict system/refineMeshDict -overwrite
runApplication snappyHexMesh -overwrite
runApplication checkMesh

restore0Dir
runApplication setFields

#runApplication renumberMesh -overwrite
#runApplication $(getApplication)

runApplication decomposePar
runParallel renumberMesh -overwrite
runParallel $(getApplication)

#runParallel redistributePar -reconstruct -overwrite
runApplication reconstructPar

#------------------------------------------------------------------------------
